<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Behavior3JS Editor</title>

  <script src="js/preloadjs-0.6.0.min.js" type="text/javascript"></script>
  <link href="css/normalize-3.0.1.min.css" rel="stylesheet">
  <link href="css/preload.css" rel="stylesheet">

  <script type="text/javascript">
    var MANIFEST = [
      {id:'', src:'img/closedhand.cur'},
      {id:'', src:'libs.js'},
      {id:'', src:'build.js'},
      {id:'', src:'build.css'},
      {id:'view', src:'build.html'},
    ];
  </script>
</head>

<body>
  <!-- PRELOAD PAGE -->
  <div id="preloading">
    <div class="content">
      <img src="img/loading.gif" alt="Loading"/>
      <p id="loading-text">
        Loading, please wait... 
        <strong><span id="loading-progress">0%</span></strong>
      </p>
    </div>
  </div>
  <!-- END PRELOAD PAGE -->
  
  <!-- APP PAGE -->
  <div id="page"></div>
  <!-- END APP PAGE -->

  
  <script type="text/javascript" src="../../../mongo_test/html/lib/ros/EventEmitter2/eventemitter2.js"></script>
  <script type="text/javascript" src="../../../mongo_test/html/lib/ros/roslibjs/roslib.js"></script>
  <script type="text/javascript">
  
      // global ROS handle
      var ros = new ROSLIB.Ros({
        url : 'ws://localhost:9090'
      });

        
      var json_listener = new ROSLIB.Topic({
        ros : ros,
        name : 'behavior_tree_json',
        messageType : 'std_msgs/String'
      });

//       json_listener.subscribe(function(message) {
//         console.log('Received message on ' + json_listener.name + ': ' + message.data);
//         app.editor.importFromJSON(message.data);
//       })
      
      var cur_listener = new ROSLIB.Topic({
        ros : ros,
        name : 'behavior_tree_current',
        messageType : 'std_msgs/String'
      });
      
      cur_listener.subscribe(function(message) {
        console.log('Received message on ' + cur_listener.name + ': ' + message.data);
        var block = app.editor.getBlockById(message.data);
        app.editor.deselectAll();
        app.editor.select(block);
      })
      
  </script>
  <script src="main.js" type="text/javascript"></script>
</body>
</html>